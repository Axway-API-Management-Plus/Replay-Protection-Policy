<entityStoreData xmlns="http://www.vordel.com/2005/06/24/entityStore">
<metaInfo flags="138">
	<exportRoots>
		<key type='CacheManager'>
			<id field='name' value='Cache Manager'/>
			<key type='DistributedCache'>
				<id field='name' value='Replay_Protection_IP_Blacklist'/>
			</key>
		</key>
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
		</key>
		<key type='ESConfiguration'>
			<id field='name' value='Entity Store Configuration'/>
		</key>
		<key type='CacheManager'>
			<id field='name' value='Cache Manager'/>
			<key type='DistributedCache'>
				<id field='name' value='Replay_Protection_Messages'/>
			</key>
		</key>
		<key type='CacheManager'>
			<id field='name' value='Cache Manager'/>
			<key type='DistributedCache'>
				<id field='name' value='Replay_Protection_Invalid_Attempts'/>
			</key>
		</key>
	</exportRoots>
	<typeVersions>
		<type name="Cache" version="0"/>
		<type name="CacheAttributeFilter" version="1"/>
		<type name="CacheManager" version="2"/>
		<type name="CopyAttribute" version="0"/>
		<type name="CopyAttributeFilter" version="1"/>
		<type name="CreateMessageKeyFilter" version="1"/>
		<type name="DistributedCache" version="0"/>
		<type name="ESConfiguration" version="30"/>
		<type name="Entity" version="0"/>
		<type name="FalseFilter" version="0"/>
		<type name="Filter" version="5"/>
		<type name="FilterCircuit" version="4"/>
		<type name="IsCachedAttributeFilter" version="1"/>
		<type name="LoadableModule" version="2"/>
		<type name="MaximumNumberMsgsFilter" version="8"/>
		<type name="NamedLoadableModule" version="0"/>
		<type name="RootChild" version="0"/>
		<type name="SetAttributeFilter" version="0"/>
		<type name="TrueFilter" version="0"/>
	</typeVersions>
	<realizedTypes><![CDATA[
<entityStoreData>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" abstract="true" extends="Entity" name="RootChild"/>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" abstract="true" extends="RootChild" name="LoadableModule">
        <constant name="_version" type="integer" value="2"/>
        <constant name="loadorder" type="integer" value="1000000"/>
        <field cardinality="?" name="classloader" type="^ClassLoader"/>

        </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" abstract="true" extends="LoadableModule" name="NamedLoadableModule">
        <constant name="_version" type="integer" value="0"/>
		<field cardinality="1" isKey="true" name="name" type="string"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="NamedLoadableModule" name="CacheManager">
            <constant name="_version" type="integer" value="2"/>
            <constant name="class" type="string" value="com.vordel.circuit.cache.CacheContainer"/>
            <constant name="loadorder" type="integer" value="1"/>
            <componentType cardinality="*" name="Cache"/>
        </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="RootChild" name="ESConfiguration">
        <constant name="_version" type="integer" value="30"/>
        <!--
            Give this singleton a key.
        -->
        <field isKey="true" name="name" type="string"/>
        <!-- 
            We use this field to verify that the passphrase for the 
            encryped data is synchronized between the server and client, and
            between multiple invocations of the client
        -->
        <field name="passphraseTest" type="encrypted"/>
        <field name="version" type="string"/>
        <!-- The product key should never change for the lifetime of the product -->
        <field name="productKey" type="string"/>
        <field cardinality="?" name="gitrev" type="string"/>
    </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="RootChild" name="FilterCircuit">
        <constant name="_version" type="integer" value="4"/>
		<componentType cardinality="*" name="Filter"/>
		<componentType cardinality="1" name="BoundCircuit"/>
		<componentType cardinality="*" name="Property"/>
		<field cardinality="1" name="start" type="@Filter"/>
		<field cardinality="?" name="fault" type="@Filter"/>
		<field isKey="true" name="name" type="string"/>
		<field cardinality="1" default="3" name="logMask" type="integer"/>

		<field cardinality="?" name="description" type="string"/>		
		<field cardinality="1" name="category" type="@PolicyCategory">
            <defaultRef>
                <key type="PolicyCategoryGroup">
                  <id field="name" value="Policy Categories"/>
                  <key type="PolicyCategory">
                      <id field="name" value="miscellaneous"/>
                  </key>
                </key>
            </defaultRef>
        </field>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Entity" name="Cache">
        <constant name="_version" type="integer" value="0"/>
    <!-- required -->
    <field isKey="true" name="name" type="string"/>
    <field cardinality="1" default="1000" name="maxElementsInMemory" type="integer"/>
    <field cardinality="1" default="1000" name="maxElementsOnDisk" type="integer"/>
    <field cardinality="1" default="true" name="eternal" type="boolean"/>
    <field cardinality="1" default="true" name="overflowToDisk" type="boolean"/>
    <!-- optional -->
    <field cardinality="1" default="0" name="timeToIdleSeconds" type="long"/>
    <field cardinality="1" default="0" name="timeToLiveSeconds" type="long"/>
    <field cardinality="1" default="false" name="diskPersistent" type="boolean"/>
    <field cardinality="1" default="120" name="diskExpiryThreadIntervalSeconds" type="long"/>    
    <field cardinality="1" default="30" name="diskSpoolBufferSizeMB" type="integer"/>
    <field cardinality="1" default="LRU" name="memoryStoreEvictionPolicy" type="string"/>
  </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Cache" name="DistributedCache">
        <constant name="_version" type="integer" value="0"/>
        <!-- event listener -->
        <field cardinality="1" default="net.sf.ehcache.distribution.RMICacheReplicatorFactory" name="eventListenerClass" type="string"/>
        <field cardinality="1" default="," name="eventListenerPropertySeparator" type="string"/>
        <field cardinality="1" default="replicateAsynchronously=false, replicatePuts=true, replicateUpdates=true, replicateUpdatesViaCopy=true, replicateRemovals=true" name="eventListenerProperties" type="string"/>
        <!-- Bootstrap Cache Loader -->
        <field cardinality="1" default="net.sf.ehcache.distribution.RMIBootstrapCacheLoaderFactory" name="bootstrapClass" type="string"/>
        <field cardinality="1" default="," name="boootstrapPropertySeparator" type="string"/>
        <field cardinality="1" default="bootstrapAsynchronously=true, maximumChunkSizeBytes=5000000" name="bootstrapProperties" type="string"/>
      </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Entity" name="CopyAttribute">
        <constant name="_version" type="integer" value="0"/>
        <!-- Key fields -->
        <field cardinality="1" isKey="true" name="fromAttributeName" type="string"/>   
        <field cardinality="1" default="" isKey="true" name="fromAttributeNamespace" type="string"/>   
        <field cardinality="1" default="" isKey="true" name="toAttributeName" type="string"/>   
        <field cardinality="1" default="" isKey="true" name="toAttributeNamespace" type="string"/>
        <!-- Other fields -->    
        <field cardinality="?" name="attributeValue" type="string"/>
        <field cardinality="1" default="1" name="fromAttributeLocation" type="integer"/>   
        <field cardinality="1" default="1" name="toAttributeLocation" type="integer"/>           
        <field cardinality="1" default="0" name="toListAttribute" type="boolean"/>          
    </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" abstract="true" extends="Entity" name="Filter">
        <constant name="_version" type="integer" value="5"/>
        <field cardinality="?" name="successNode" type="@Filter"/>
        <field cardinality="?" name="failureNode" type="@Filter"/>
        <field isKey="true" name="name" type="string"/>
        <field cardinality="1" default="2" name="logMask" type="integer"/>
        <field cardinality="1" default="Filter aborted due to exception" name="logFatal" type="string"/>
        <field cardinality="1" default="Filter failed" name="logFailure" type="string"/>
        <field cardinality="1" default="Filter passed" name="logSuccess" type="string"/>
        <field cardinality="1" name="category" type="@Category">
            <defaultRef>
                <key type="CategoryGroup">
                  <id field="name" value="Filter Categories"/>
                  <key type="Category">
                      <id field="name" value="miscellaneous"/>
                  </key>
                </key>
            </defaultRef>
        </field>
      <field cardinality="1" default="0" name="abortProcessingOnLogError" type="boolean"/>
      <field cardinality="1" default="SERVICE" name="logMaskType" type="string"/>
      <field cardinality="*" name="classloader" type="^ClassLoader"/>
    </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="SetAttributeFilter">
        <constant name="_version" type="integer" value="0"/>
  
    <!-- Name of the Filter class that encapsulates this configuration entity -->
    <constant name="class" type="string" value="com.vordel.circuit.attribute.SetAttributeFilter"/>
    
    <!-- List of the configuration parameters, their types, and their default values -->
    <field cardinality="1" default="" name="messageAttribute" type="string"/>	
    <field cardinality="1" default="" name="attributeValue" type="string"/>	
  </entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="CacheAttributeFilter">
        <constant name="_version" type="integer" value="1"/>	    
	    <constant name="class" type="string" value="com.vordel.circuit.cache.CacheAttributeFilter"/>
        <field cardinality="1" name="cacheToUse" type="^Cache"/>
	    <field cardinality="1" default="message.key" name="keyAttributeName" type="string"/>
		<field cardinality="1" default="content.body" name="attributeName" type="string"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="IsCachedAttributeFilter">
        <constant name="_version" type="integer" value="1"/>	    
	    <constant name="class" type="string" value="com.vordel.circuit.cache.IsCachedAttributeFilter"/>
        <field cardinality="1" name="cacheToUse" type="^Cache"/>
	    <field cardinality="1" default="message.key" name="keyAttributeName" type="string"/>
		<field cardinality="1" default="content.body" name="attributeName" type="string"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="TrueFilter">
        <constant name="_version" type="integer" value="0"/>
		<constant name="class" type="string" value="com.vordel.circuit.basic.True"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="CopyAttributeFilter">
        <constant name="_version" type="integer" value="1"/>
        <constant name="class" type="string" value="com.vordel.circuit.attribute.CopyAttributeFilter"/>    
	    <componentType cardinality="+" name="CopyAttribute"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="CreateMessageKeyFilter">
        <constant name="_version" type="integer" value="1"/>	    
	    <constant name="class" type="string" value="com.vordel.circuit.cache.CreateMessageKeyFilter"/>
	    <field cardinality="1" default="content.body" name="uniqueAttributeName" type="string"/>
	    <field cardinality="1" default="message.key" name="outputAttributeName" type="string"/>
	</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="MaximumNumberMsgsFilter">
  <constant name="_version" type="integer" value="8"/>
  <constant name="class" type="string" value="com.vordel.circuit.throttling.MaximumNumberMsgsFilter"/>

  <!-- common fields -->
  <field default="0" name="insertRateLimitingHeaders" type="boolean"/>
  <field name="xRateLimitResponseHeaderStem" type="string"/>
  <field cardinality="1" default="FTW" name="algorithm" type="string"/>
    
  <!-- fields relevant for FTW (ehCache)  -->                     
  <field cardinality="1" default="1" name="numberMessages" type="string"/>
  <field cardinality="1" default="1" name="timePeriod" type="string"/>    
  <field cardinality="1" default="second" name="timePeriodUnit" type="string"/>
  <field cardinality="1" default="1" name="trackPerKey" type="boolean"/>
  <field cardinality="?" default="${http.request.clientaddr.getAddress()}" name="key" type="string"/>
  <field cardinality="1" name="cacheToUse" type="^Cache">
    <defaultRef>  
      <key type="CacheManager">
        <id field="name" value="Cache Manager"/>
        <key type="Cache">
          <id field="name" value="Local maximum messages"/>
        </key>
      </key>
    </defaultRef>
  </field>
  <field cardinality="1" default="0" name="timePeriodStartHour" type="integer"/>
  <field cardinality="1" default="1" name="timePeriodStartDay" type="integer"/>

  <!-- fields relevant for SRL (Cassandra)  -->
  <field cardinality="1" default="1" name="numberMessagesPerSecond" type="string"/>
  <field cardinality="1" default="EVENLY" name="strategy" type="string"/>
  <field cardinality="1" default="0" name="burstSize" type="integer"/>
</entityType>
<entityType xmlns="http://www.vordel.com/2005/06/24/entityStore" extends="Filter" name="FalseFilter">
        <constant name="_version" type="integer" value="0"/>
		<constant name="class" type="string" value="com.vordel.circuit.basic.False"/>
	</entityType>
</entityStoreData>
	]]></realizedTypes>
</metaInfo>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="DistributedCache">
	<key type='CacheManager'>
		<id field='name' value='Cache Manager'/>
	</key>
	<fval name="boootstrapPropertySeparator"><value>,</value></fval>
	<fval name="bootstrapClass"><value>net.sf.ehcache.distribution.RMIBootstrapCacheLoaderFactory</value></fval>
	<fval name="bootstrapProperties"><value>bootstrapAsynchronously=true, maximumChunkSizeBytes=5000000</value></fval>
	<fval name="diskExpiryThreadIntervalSeconds"><value>120</value></fval>
	<fval name="diskPersistent"><value>0</value></fval>
	<fval name="diskSpoolBufferSizeMB"><value>30</value></fval>
	<fval name="eternal"><value>0</value></fval>
	<fval name="eventListenerClass"><value>net.sf.ehcache.distribution.RMICacheReplicatorFactory</value></fval>
	<fval name="eventListenerProperties"><value>replicateAsynchronously=false, replicatePuts=true, replicateUpdates=true, replicateUpdatesViaCopy=true, replicateRemovals=true</value></fval>
	<fval name="eventListenerPropertySeparator"><value>,</value></fval>
	<fval name="maxElementsInMemory"><value>1000</value></fval>
	<fval name="maxElementsOnDisk"><value>1000</value></fval>
	<fval name="memoryStoreEvictionPolicy"><value>LRU</value></fval>
	<fval name="name"><value>Replay_Protection_IP_Blacklist</value></fval>
	<fval name="overflowToDisk"><value>1</value></fval>
	<fval name="timeToIdleSeconds"><value>0</value></fval>
	<fval name="timeToLiveSeconds"><value>300</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CacheManager">
	<fval name="name"><value>Cache Manager</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="FilterCircuit">
	<fval name="category"><value contentType="reference">
		<key type='PolicyCategoryGroup'>
			<id field='name' value='Policy Categories'/>
			<key type='PolicyCategory'>
				<id field='name' value='security'/>
			</key>
		</key>
	</value></fval>
	<fval name="description"><value>This policy prevents from Replay attack</value></fval>
	<fval name="logMask"><value>3</value></fval>
	<fval name="name"><value>01_ReplayProtection</value></fval>
	<fval name="start"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='SetAttributeFilter'>
				<id field='name' value='Set Attribute Filter incomingIPAddress'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="SetAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeValue"><value>${http.request.clientaddr}</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failed to set the attribute value</value></fval>
	<fval name="logFatal"><value>Error while setting the attribute value. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Set the attribute value</value></fval>
	<fval name="messageAttribute"><value>incomingIPAddress</value></fval>
	<fval name="name"><value>Set Attribute Filter incomingIPAddress</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='IsCachedAttributeFilter'>
				<id field='name' value='Is the incoming IP Address in the IP blacklist cache?'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CopyAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failed to copy attributes</value></fval>
	<fval name="logFatal"><value>Error occurred while copying attributes. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Copied attributes successfully</value></fval>
	<fval name="name"><value>Set error attributes - Anti replay mechanism </value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='SetAttributeFilter'>
				<id field='name' value='Set - HTTP Status (ReplayProtection)'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CopyAttribute">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
		<key type='CopyAttributeFilter'>
			<id field='name' value='Set error attributes - Anti replay mechanism '/>
		</key>
	</key>
	<fval name="attributeValue"><value>Transfer for Service ${http.request.path} blocked by anti-replay protection mechanism rule violation, bloked message from ${http.request.clientaddr.getHostName()}. Transaction ID ${id}.</value></fval>
	<fval name="fromAttributeLocation"><value>3</value></fval>
	<fval name="fromAttributeName"><value></value></fval>
	<fval name="fromAttributeNamespace"><value></value></fval>
	<fval name="toAttributeLocation"><value>1</value></fval>
	<fval name="toAttributeName"><value>error.description</value></fval>
	<fval name="toAttributeNamespace"><value></value></fval>
	<fval name="toListAttribute"><value>0</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CopyAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failed to copy attributes</value></fval>
	<fval name="logFatal"><value>Error occurred while copying attributes. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Copied attributes successfully</value></fval>
	<fval name="name"><value>Set error attributes - IP dynamic blacklist </value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='SetAttributeFilter'>
				<id field='name' value='Set - HTTP Status (IP BlackListed)'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CopyAttribute">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
		<key type='CopyAttributeFilter'>
			<id field='name' value='Set error attributes - IP dynamic blacklist '/>
		</key>
	</key>
	<fval name="attributeValue"><value>Transfer for Service ${http.request.path} blocked by dynamic IP blacklist rule violation, through Replay Protection rule, Blocked IP (${http.request.clientaddr.getHostName()}). Transaction ID ${id}.</value></fval>
	<fval name="fromAttributeLocation"><value>3</value></fval>
	<fval name="fromAttributeName"><value></value></fval>
	<fval name="fromAttributeNamespace"><value></value></fval>
	<fval name="toAttributeLocation"><value>1</value></fval>
	<fval name="toAttributeName"><value>error.description</value></fval>
	<fval name="toAttributeNamespace"><value></value></fval>
	<fval name="toListAttribute"><value>0</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="IsCachedAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeName"><value>incomingIPAddress</value></fval>
	<fval name="cacheToUse"><value contentType="reference">
<key type='CacheManager'><id field='name' value='Cache Manager'/><key type='DistributedCache'><id field='name' value='Replay_Protection_IP_Blacklist'/></key></key>	</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="failureNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='CreateMessageKeyFilter'>
				<id field='name' value='Create Key (incoming msg hash)'/>
			</key>
		</key>
	</value></fval>
	<fval name="keyAttributeName"><value>incomingIPAddress</value></fval>
	<fval name="logFailure"><value>IP-Address NOT found in the IP-Blacklist cache. Continue processing.</value></fval>
	<fval name="logFatal"><value>Error while looking for key in the  message attribiute cache. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>&#xD;&#xA;IP-Address FOUND in the IP-Blacklist cache. Stop processing.</value></fval>
	<fval name="name"><value>Is the incoming IP Address in the IP blacklist cache?</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='CopyAttributeFilter'>
				<id field='name' value='Set error attributes - IP dynamic blacklist '/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="TrueFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value></value></fval>
	<fval name="logFatal"><value>True filter error. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>True filter passed</value></fval>
	<fval name="name"><value>Replay Protection is Passed</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="FalseFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Filter failed</value></fval>
	<fval name="logFatal"><value>False filter error. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value></value></fval>
	<fval name="name"><value>Blocked by Replay_Protection rule violation</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CreateMessageKeyFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failure during creationo of message key from attribute.</value></fval>
	<fval name="logFatal"><value>Error during message creation of message key from attribute. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Message key created from attribute.</value></fval>
	<fval name="name"><value>Create Key (incoming msg hash)</value></fval>
	<fval name="outputAttributeName"><value>message.key</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='IsCachedAttributeFilter'>
				<id field='name' value='Is message already cached?'/>
			</key>
		</key>
	</value></fval>
	<fval name="uniqueAttributeName"><value>content.body</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="SetAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeValue"><value>403</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failed to set the attribute value</value></fval>
	<fval name="logFatal"><value>Error while setting the attribute value. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Set the attribute value</value></fval>
	<fval name="messageAttribute"><value>response.code</value></fval>
	<fval name="name"><value>Set - HTTP Status (IP BlackListed)</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='FalseFilter'>
				<id field='name' value='Blocked by IP dynamic blacklist'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CacheAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeName"><value>content.body</value></fval>
	<fval name="cacheToUse"><value contentType="reference">
<key type='CacheManager'><id field='name' value='Cache Manager'/><key type='DistributedCache'><id field='name' value='Replay_Protection_Messages'/></key></key>	</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="keyAttributeName"><value>message.key</value></fval>
	<fval name="logFailure"><value>Failed to cache the message attribute.</value></fval>
	<fval name="logFatal"><value>Error while caching the message attribute. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Cached the message attribute.</value></fval>
	<fval name="name"><value>Cache the msg hash</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='TrueFilter'>
				<id field='name' value='Replay Protection is Passed'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="SetAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeValue"><value>400</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Failed to set the attribute value</value></fval>
	<fval name="logFatal"><value>Error while setting the attribute value. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Set the attribute value</value></fval>
	<fval name="messageAttribute"><value>response.code</value></fval>
	<fval name="name"><value>Set - HTTP Status (ReplayProtection)</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='FalseFilter'>
				<id field='name' value='Blocked by Replay_Protection rule violation'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="CacheAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeName"><value>incomingIPAddress</value></fval>
	<fval name="cacheToUse"><value contentType="reference">
<key type='CacheManager'><id field='name' value='Cache Manager'/><key type='DistributedCache'><id field='name' value='Replay_Protection_IP_Blacklist'/></key></key>	</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="keyAttributeName"><value>incomingIPAddress</value></fval>
	<fval name="logFailure"><value>Failure while adding IP-Address: ${incomingIPAddress} to the dynamic blacklist cache.</value></fval>
	<fval name="logFatal"><value>Error while caching the message attribute. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>6</value></fval>
	<fval name="logMaskType"><value>FILTER</value></fval>
	<fval name="logSuccess"><value>IP-Address: ${incomingIPAddress} succesfully added to the dynamic blacklist cache.</value></fval>
	<fval name="name"><value>Cache the IP address in the dynamic IP BL cache</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='CopyAttributeFilter'>
				<id field='name' value='Set error attributes - Anti replay mechanism '/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="IsCachedAttributeFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="attributeName"><value>content.body</value></fval>
	<fval name="cacheToUse"><value contentType="reference">
<key type='CacheManager'><id field='name' value='Cache Manager'/><key type='DistributedCache'><id field='name' value='Replay_Protection_Messages'/></key></key>	</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="failureNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='CacheAttributeFilter'>
				<id field='name' value='Cache the msg hash'/>
			</key>
		</key>
	</value></fval>
	<fval name="keyAttributeName"><value>message.key</value></fval>
	<fval name="logFailure"><value>Message hash NOT FOUND in the cache. Continue processing.</value></fval>
	<fval name="logFatal"><value>Error while looking for key in the  message attribiute cache. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>6</value></fval>
	<fval name="logMaskType"><value>FILTER</value></fval>
	<fval name="logSuccess"><value>Message hash FOUND in the cache. Already played. Stop processing.</value></fval>
	<fval name="name"><value>Is message already cached?</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='MaximumNumberMsgsFilter'>
				<id field='name' value='Pass IP till x invalid attempts'/>
			</key>
		</key>
	</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="MaximumNumberMsgsFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="algorithm"><value>FTW</value></fval>
	<fval name="burstSize"><value>0</value></fval>
	<fval name="cacheToUse"><value contentType="reference">
<key type='CacheManager'><id field='name' value='Cache Manager'/><key type='DistributedCache'><id field='name' value='Replay_Protection_Invalid_Attempts'/></key></key>	</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="failureNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='CacheAttributeFilter'>
				<id field='name' value='Cache the IP address in the dynamic IP BL cache'/>
			</key>
		</key>
	</value></fval>
	<fval name="insertRateLimitingHeaders"><value>0</value></fval>
	<fval name="key"><value>${incomingIPAddress}</value></fval>
	<fval name="logFailure"><value>Maximum number of messages filter was triggered</value></fval>
	<fval name="logFatal"><value>Throttle filter aborted: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value>Maximum number of messages filter was not triggered</value></fval>
	<fval name="name"><value>Pass IP till x invalid attempts</value></fval>
	<fval name="numberMessages"><value>3</value></fval>
	<fval name="numberMessagesPerSecond"><value>1</value></fval>
	<fval name="strategy"><value>EVENLY</value></fval>
	<fval name="successNode"><value contentType="reference">
		<key type='FilterCircuit'>
			<id field='name' value='01_ReplayProtection'/>
			<key type='TrueFilter'>
				<id field='name' value='Replay Protection is Passed'/>
			</key>
		</key>
	</value></fval>
	<fval name="timePeriod"><value>1</value></fval>
	<fval name="timePeriodStartDay"><value>1</value></fval>
	<fval name="timePeriodStartHour"><value>0</value></fval>
	<fval name="timePeriodUnit"><value>minute</value></fval>
	<fval name="trackPerKey"><value>1</value></fval>
	<fval name="xRateLimitResponseHeaderStem"><value></value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="FalseFilter">
	<key type='FilterCircuit'>
		<id field='name' value='01_ReplayProtection'/>
	</key>
	<fval name="abortProcessingOnLogError"><value>0</value></fval>
	<fval name="category"><value contentType="reference">
		<key type='CategoryGroup'>
			<id field='name' value='Filter Categories'/>
			<key type='Category'>
				<id field='name' value='miscellaneous'/>
			</key>
		</key>
	</value></fval>
	<fval name="logFailure"><value>Filter failed</value></fval>
	<fval name="logFatal"><value>False filter error. Error: ${circuit.exception}</value></fval>
	<fval name="logMask"><value>2</value></fval>
	<fval name="logMaskType"><value>SERVICE</value></fval>
	<fval name="logSuccess"><value></value></fval>
	<fval name="name"><value>Blocked by IP dynamic blacklist</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="ESConfiguration">
	<fval name="name"><value>Entity Store Configuration</value></fval>
	<fval name="passphraseTest"><value>aHR0cDsvL3d3dy52b3JkZWwuY29t</value></fval>
	<fval name="productKey"><value>VordelGateway</value></fval>
	<fval name="version"><value>7.7.0</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="DistributedCache">
	<key type='CacheManager'>
		<id field='name' value='Cache Manager'/>
	</key>
	<fval name="boootstrapPropertySeparator"><value>,</value></fval>
	<fval name="bootstrapClass"><value>net.sf.ehcache.distribution.RMIBootstrapCacheLoaderFactory</value></fval>
	<fval name="bootstrapProperties"><value>bootstrapAsynchronously=true, maximumChunkSizeBytes=5000000</value></fval>
	<fval name="diskExpiryThreadIntervalSeconds"><value>120</value></fval>
	<fval name="diskPersistent"><value>0</value></fval>
	<fval name="diskSpoolBufferSizeMB"><value>30</value></fval>
	<fval name="eternal"><value>0</value></fval>
	<fval name="eventListenerClass"><value>net.sf.ehcache.distribution.RMICacheReplicatorFactory</value></fval>
	<fval name="eventListenerProperties"><value>replicateAsynchronously=false, replicatePuts=true, replicateUpdates=true, replicateUpdatesViaCopy=true, replicateRemovals=true</value></fval>
	<fval name="eventListenerPropertySeparator"><value>,</value></fval>
	<fval name="maxElementsInMemory"><value>1000</value></fval>
	<fval name="maxElementsOnDisk"><value>1000</value></fval>
	<fval name="memoryStoreEvictionPolicy"><value>LRU</value></fval>
	<fval name="name"><value>Replay_Protection_Messages</value></fval>
	<fval name="overflowToDisk"><value>1</value></fval>
	<fval name="timeToIdleSeconds"><value>0</value></fval>
	<fval name="timeToLiveSeconds"><value>300</value></fval>
</entity>
<entity xmlns="http://www.vordel.com/2005/06/24/entityStore"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" type="DistributedCache">
	<key type='CacheManager'>
		<id field='name' value='Cache Manager'/>
	</key>
	<fval name="boootstrapPropertySeparator"><value>,</value></fval>
	<fval name="bootstrapClass"><value>net.sf.ehcache.distribution.RMIBootstrapCacheLoaderFactory</value></fval>
	<fval name="bootstrapProperties"><value>bootstrapAsynchronously=true, maximumChunkSizeBytes=5000000</value></fval>
	<fval name="diskExpiryThreadIntervalSeconds"><value>120</value></fval>
	<fval name="diskPersistent"><value>0</value></fval>
	<fval name="diskSpoolBufferSizeMB"><value>30</value></fval>
	<fval name="eternal"><value>0</value></fval>
	<fval name="eventListenerClass"><value>net.sf.ehcache.distribution.RMICacheReplicatorFactory</value></fval>
	<fval name="eventListenerProperties"><value>replicateAsynchronously=false, replicatePuts=true, replicateUpdates=true, replicateUpdatesViaCopy=true, replicateRemovals=true</value></fval>
	<fval name="eventListenerPropertySeparator"><value>,</value></fval>
	<fval name="maxElementsInMemory"><value>1000</value></fval>
	<fval name="maxElementsOnDisk"><value>1000</value></fval>
	<fval name="memoryStoreEvictionPolicy"><value>LRU</value></fval>
	<fval name="name"><value>Replay_Protection_Invalid_Attempts</value></fval>
	<fval name="overflowToDisk"><value>1</value></fval>
	<fval name="timeToIdleSeconds"><value>0</value></fval>
	<fval name="timeToLiveSeconds"><value>86400</value></fval>
</entity>
</entityStoreData>